/* LepaParser.cup - CUP parser for LEPA */
package parser;

import java_cup.runtime.*;
import java.util.*;

parser code {:
    public void report_error(String message, Object info) {
        System.err.println("Syntax error: " + message);
    }
    
    /* Expecting 2 shift/reduce conflicts */
    public int getExpectedConflicts() {
        return 2;
    }
:};

terminal THEOREM, PROOF, QED, ASSUME, END, LET, IN, NOTIN, SUBSET, UNION, INTERSECT, FORALL, EXISTS;
terminal TRUE, FALSE, BY, FROM, THEREFORE;
terminal AND, OR, NOT, IMPLIES, IFF;
terminal EQ, NEQ;
terminal LPAREN, RPAREN, LBRACE, RBRACE, COMMA, DOT, COLON, SETDIFF;
terminal Integer NUMBER;
terminal String IDENTIFIER;

non terminal program, theorem_list, theorem_decl, formula, proof_block, proof_steps, proof_step;
non terminal id_term, function_call;
non terminal expr, term_list, term, predicate, justification;

precedence left IFF;
precedence left IMPLIES;
precedence left OR;
precedence left AND;
precedence right NOT;



start with program;

program ::= theorem_list ;

theorem_list ::= theorem_list theorem_decl
               | theorem_decl ;

theorem_decl ::= THEOREM IDENTIFIER COLON formula DOT PROOF COLON proof_steps QED DOT ;

proof_steps ::= proof_steps proof_step
              | proof_step ;

proof_step ::= ASSUME formula
             | END
             | THEREFORE formula BY justification
             | THEREFORE formula
             | formula BY justification
             | formula ;

justification ::= IDENTIFIER FROM term_list
                | IDENTIFIER ;

formula ::= TRUE
          | FALSE
          | id_term
          | formula AND formula
          | formula OR formula
          | formula IMPLIES formula
          | formula IFF formula
          | NOT formula
          | FORALL term_list DOT formula
          | EXISTS term_list DOT formula
          | term EQ term
          | term NEQ term
          | term IN term
          | term NOTIN term
          | term SUBSET term
          | LPAREN formula RPAREN ;

term_list ::= term_list COMMA term
            | term ;

id_term ::= IDENTIFIER ;

term ::= IDENTIFIER
       | NUMBER
       | function_call
       | LBRACE term_list RBRACE ;

function_call ::= IDENTIFIER LPAREN term_list RPAREN ;

